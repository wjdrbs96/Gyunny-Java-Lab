# `프로세스와 쓰레드`

먼저 `스레드`와 `프로세스`에 대해서 알아보겠습니다. 먼저 `프로세스`부터 보겠습니다. 

<br>

## `프로세스(process)란?`

먼저 프로그램과 프로세스의 차이는 무엇일까요? 프로그램은 저장장치에 저장되어 있는 정적인 상태이고, 프로세스는 실행을 위해 메모리에 올라온 동적인 상태입니다.

운영체제는 프로그램을 메모리의 적당한 위치로 가져오고, 그와 동시에 `프로세스 제어 블록`을 만듭니다.(프로세스를 처리하는데 필요한 다양한 정보가 들어있습니다.)

- 프로세스 = 프로그램 + 프로세스 제어 블록

위와 같이 프로세스를 정의할 수 있습니다. 

![process](https://s3.ap-northeast-2.amazonaws.com/static.gracieuxyh.dev/os/process-life-cycle.png)

- `생성(new) : 프로세스가 메모리에 올라와 실행 준비를 완료한 상태입니다.`
- `준비(ready) : 생성된 프로세스가 CPU를 얻을 때까지 기다리는 상태`
- `수행(running) : 준비 상태에 있는 프로세스 중 하나가 CPU를 얻어 실제 작업을 수행하는 상태`
- `대기(waiting) : 실행 상태에 있는 프로세스가 입출력을 요청하면 입출력이 완료될 때까지 기다리는 상태`
- `종료(exit) : 프로세스가 종료된 상태`

<br>

## `프로세스의 구조`

프로세스는 `코드 영역`, `데이터 영역`, `스택 영역`, `힙 영역` 으로 구성됩니다. 

![structure](https://media.vlpt.us/images/fldfls/post/d9e8bc7c-2a55-4c20-9697-4c3d695be8e6/image.png)

- `코드(Code) : 프로그램 명령이 위치하는 곳`
- `데이터(Data) : 전역 변수나 static 변수의 할당을 위해 존재하는 공간`
- `스택(Stack) : 지역 변수 할당, 함수 호출 시 전달되는 인자 값들을 저장하기 위한 공간`
- `힙(Heap) : Java의 new를 통한 동적 할당을 위해 존재하는 공간`

<br>

## 스레드(Thread)란?

예시를 들면 `프로세스는 요리 작업 전체와 같고`, `쓰레드는 요리를 완성하기 위해 수행하는 각각의 조리에 해당하는 것`입니다.
프로세스의 작업 과정을 자세히 알아보겠습니다. 

- 운영체제는 코드와 데이터를 메모리에 가져오고, 프로세스 제어 블록을 생성합니다. 
- 작업에 필요한 메모리 영역을 확보한 후, 준비된 프로세스를 준비 큐에 삽입합니다. 
- 프로세스가 생성되면 CPU 스케줄러는 프로세스가 해야 할 일을 CPU에 전달하고 실제 작업은 CPU가 수행합니다. (이때 `CPU 스케줄러가 CPU에 전달하는 일 하나가 스레드입니다.`)

운영체제 입장에서의 작업 단위는 `프로세스`이고, CPU 입장에서의 작업 단위는 `스레드`입니다. 

- 스레드는 프로세스 내에서 각각 Stack만 따로 할당받고 `Code`, `Data`, `Heap` 영역은 공유합니다. 

![Thread](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2Fbhu4yo%2FbtqDx5JbeQk%2FnIiiT7ThGKRldVLtQhf6VK%2Fimg.png)

위와 같이 `쓰레드는 한 프로세스 내에서 동작되는 여러 실행의 흐름으로 자원들을 공유하면서 실행됩니다.`

<br>

## `자바 스레드(Java Thread)란?`

- 일반 스레드와 거의 차이가 없으며, JVM이 운영체제 역할을 합니다.
- 자바 스레드는 JVM에 의해 스케줄되는 실행 단위 코드 블럭입니다. (JVM 내에 메모리를 공유하여 사용합니다.)
- main() 메소드가 수행되면서 하나의 스레드가 실행되는 것입니다. 

<br>

### `스레드를 만든 이유는 무엇일까요?`

프로세스가 하나 시작하려면 많은 자원이 필요합니다. 만약 하나의 작업을 동시에 수행하려고 할 때 여러 개의 프로세스를 띄워서 실행하면 각각 메모리를 할당하여 주어야만 합니다. 

JVM은 기본적으로 아무런 옵션 없이 실행하면 OS마다 다르지만, 적어도 32MB ~ 64MB의 물리 메모리를 점유합니다. 그에 반해, 스레드를 하나 추가하면 1MB 이내의 메모리를 점유합니다. 

그리고 요즘은 웬만한 PC에서는 두 개 이상의 코어가 있는 멀티 코어 시대이기 때문에 대부분의 작업은 단일 스레드로 실행하는 것보다는 다중 스레드로 실행하는 것이 더 빠릅니다. 

<br>

프로세스 구조 - 스택(Stack), 힙(Heap)에 대해 더 자세히 알고 싶다면 [여기](https://github.com/wjdrbs96/Today-I-Learn/blob/master/Java/Java-Basic/%EC%9E%90%EB%B0%94%EB%A9%94%EB%AA%A8%EB%A6%AC.md) 에서 참조하면 좋습니다. 

그리고 다음 글에서는 `자바에서 쓰레드를 구현하고 실행`하는 법에 대해서 알아보겠습니다.